<form [formGroup]="stageRolesForm">
    <div class="row mt-3">
        <div class="col-md-8 clo-lg-8">
            <div class="row">
                <div class="col-md-6">
                    <mat-form-field matTooltip="Example : Choose an option from the drop down"
                        [matTooltipPosition]="tooltipPosition" class="full-width">
                        <mat-label>Review Stage</mat-label>
                       
                        <mat-select [(value)]="reviewStageCtrl" (selectionChange)="onChangeReviewStage($event)">
                            <mat-option style="color: rgb(9, 2, 2);" *ngFor="let reviewStage of reviewStageList"
                               [value]="reviewStage.rvwStage">
                                {{reviewStage.description + " (" + reviewStage.rvwStage + ")" }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="col-md-6">
                    <mat-form-field matTooltip="Example : Choose an option from the drop down"
                        [matTooltipPosition]="tooltipPosition" class="full-width">
                        <mat-label>Role Class</mat-label>
                        <mat-select (selectionChange)="onChangeRoleClass($event)" [(ngModel)]="roleClassCtrl">
                            <mat-option style="color: rgb(9, 2, 2);" *ngFor="let roleClass of roleClassList"
                                [selected]="roleClass.refCode === roleClassCtrl" [value]="roleClass.refCode">
                                {{roleClass.refDesc }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>
        </div>
    </div>
    <div class="mt-3 container " style="padding: 0px">
        <mat-tab-group animationDuration="0ms" headerPosition="above" [selectedIndex]="1">
            <mat-tab label="Stage Roles">
                <table style="border: 1px solid #efefef; width: 100%;" class="mt-4 w-100 table-hover" mat-table
                    [dataSource]="dataSourceStageRoleTypes" matSort>
                    <ng-container matColumnDef="position">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header style="width: 10%"> # </th>
                        <td mat-cell style="width: 10%" *matCellDef="let element; let i = index">{{i + 1}}</td>
                    </ng-container>

                    <ng-container matColumnDef="roleClass">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%"> Role Class </th>
                        <td mat-cell *matCellDef="let element" style="width: 10%">
                            <mat-form-field style="width: 90%;">
                                <mat-select [(value)]="element.roleCls" [disabled]="!isStageRoleEdit">
                                    <mat-option style="color: rgb(9, 2, 2);" *ngFor="let roleClass of roleClassList"
                                        [value]="roleClass.refCode">
                                        {{roleClass.refDesc}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="roleType">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%"> Role Type</th>
                        <td mat-cell *matCellDef="let element;" style="width: 10%">
                       
                            <mat-form-field style="width: 90%;">
                               
                                <mat-select [(value)]="element.roleType" [disabled]="!isStageRoleEdit">
                                    <ng-container *ngFor="let roleType of roleTypeList">
                   
                                    <mat-option style="color: rgb(9, 2, 2);" *ngIf="element.roleCls===roleType.refSubType" 
                                        [value]="roleType.refCode">
                                        {{roleType.refDesc}}
                                    </mat-option>
                                </ng-container>
                                </mat-select>
                            </mat-form-field>
                       
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="roleIndicator">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%"> Role Indicator </th>
                        <td mat-cell *matCellDef="let element;" style="width: 10%;display:flex;flex-direction:column ">
                            <mat-radio-group  aria-labelledby="example-radio-group-label" class="col-lg-9"
                                [(ngModel)]="roleIndicatorCtrl" class="radio-group">
                                <mat-radio-button [checked]="element.roleInd===roleIndicator.key"
                                    class="radio-button col-md-3" style="font-size: 12px;"
                                    *ngFor="let roleIndicator of roleIndicatorList" [value]="roleIndicator.key"
                                    [disabled]="!isStageRoleEdit">
                                    {{ roleIndicator.label }}
                                </mat-radio-button>
                            </mat-radio-group>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="roleRequired">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%;padding:10px"> Role Required </th>
                        <td mat-cell *matCellDef="let element;" style="width: 10%;padding:10px">
                            <mat-slide-toggle [labelPosition]="myLabelPosition"
                            [checked]="element.roleReqd === 'Y' ? true : false"  [disabled]="!isStageRoleEdit"
                            (change)="element.roleReqd === 'Y'? element.roleReqd='N':element.roleReqd='Y'">
            </mat-slide-toggle>
                            
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="roleRule">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%;padding:10px"> Role Rule </th>
                        <td mat-cell *matCellDef="let element;" style="width: 10%;padding:10px">
                            <mat-form-field style="width: 90%;">
                                <mat-select [(value)]="element.roleRule" [disabled]="!isStageRoleEdit">
                                    <mat-option style="color: rgb(9, 2, 2);" *ngFor="let roleRule of roleRuleList"
                                        [value]="roleRule.item_id">
                                        {{roleRule.item_text}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="min">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%"> Min </th>
                        <td mat-cell *matCellDef="let element" style="width: 10%;padding:10px">
                            <mat-form-field class="example-full-width col-lg-12" appearance="legacy">
                                 <input class="col-lg-2" [value]="element.minNos" type="number" matInput placeholder="Minimum"
                                    formControlName="minNos" [disabled]="!isStageRoleEdit">
                            </mat-form-field>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="max">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%"> Max </th>
                        <td mat-cell *matCellDef="let element" style="width: 10%;padding:10px">
                            <mat-form-field class="example-full-width col-lg-12" appearance="legacy">
                                <input class="col-lg-2" [value]="element.maxNos" type="number" matInput placeholder="Maximum"
                                    formControlName="maxNos" [disabled]="!isStageRoleEdit">
                            </mat-form-field>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="dataSource">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%"> Data Source</th>
                        <td mat-cell *matCellDef="let element;" style="width: 10%;padding:10px">
                            <mat-form-field style="width: 90%;">
                                <mat-select [(value)]="element.dataSrc" [disabled]="!isStageRoleEdit">
                                    <mat-option style="color: rgb(9, 2, 2);" *ngFor="let dataSrc of dataSrcList"
                                        [value]="dataSrc.item_id">
                                        {{dataSrc.item_text}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="delete">
                        <th mat-header-cell *matHeaderCellDef style="width: 10%"> Delete</th>
                        <td mat-cell *matCellDef="let element" style="width: 10%">
                            <a (click)="openDialog(element)">
                                <mat-icon color="warn">delete</mat-icon>
                            </a>
                        </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="displayedFields"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedFields;"></tr>
                </table>
            </mat-tab>
        </mat-tab-group>
        <div class="dropdown">
            <button class="" mat-raised-button color="primary" *ngIf="isStageRoleEdit" (click)="saveStageRoles()"
                style="z-index:1000 ;">Save</button>
            <button class="" type="button" mat-raised-button color="primary" (click)="addStageRole()"
                *ngIf="!isStageRoleEdit" style="z-index:1000 ;">Add New Roles</button>
            <button mat-button color="primary" *ngIf="!isStageRoleEdit" style="z-index:1000 ;"
                (click)="editStageRoles()">
                <mat-icon color="accent" style="font-size: 20px;" class="ft-size">edit</mat-icon>Edit
            </button>
            <button class="mt-n1" mat-button color="primary" style="z-index:1000 ;" (click)="editStageRoles()"
                *ngIf="isStageRoleEdit">
                <mat-icon color="accent" class="ft-size">cancel</mat-icon>Cancel
            </button>
        </div>
    </div>
</form>
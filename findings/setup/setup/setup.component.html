<div class="row">
  <div class="col-lg-5">
    <h6>ARC</h6>
  </div>

  <div class="col-lg-4" *ngIf="mode!=''">
    <mat-form-field class="full-width">
      <input matInput [matAutocomplete]="autoFinding" [formControl]="searchFinding"
        placeholder="Min 3 Characters Ex. Ogs" />
      <button *ngIf="searchFinding" matSuffix mat-icon-button aria-label="Clear" (click)="clearSelection1()">
        <mat-icon>close</mat-icon>
      </button>
      <div style="margin-bottom: -30px">
        <mat-icon style="margin-top: -2px" matSuffix></mat-icon>
      </div>
      <span matSuffix>
        <mat-icon matSuffix>search</mat-icon>
      </span>
      <mat-label>Search ARC </mat-label>
      <mat-autocomplete [panelWidth]="670" #autoFinding="matAutocomplete" [displayWith]="displayWithFinding">
        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
        <ng-container *ngIf="!isLoading">
          <mat-option (click)="selectFinding(find)" *ngFor="let find of filteredFinding" [value]="find">
            <span><b>{{find.cfaDesc}}</b>
            </span>
          </mat-option>
        </ng-container>
      </mat-autocomplete>
    </mat-form-field>
  </div>

  <div class="col-lg-1 " *ngIf="findingValueCopy != '' && mode != 'add'">
    <button (click)="addFinding()" class="mt-1" mat-button color="primary">
      <mat-icon color="accent">add</mat-icon>Add
    </button>
  </div>
  <div class="col-lg-1" *ngIf="mode === 'add'">
    <button (click)="addFindingNewRow()" class="mt-1" mat-button color="primary">
      <mat-icon color="accent">add</mat-icon>Add New Row
    </button>
  </div>
</div>

<div class="mat-elevation-z8 table-responsive mb-4" *ngIf="findingSetups">

  <table class="w-100 table-hover" #table mat-table [dataSource]="findingSetups" matSort>



    <ng-container matColumnDef="arcDesc">
      <th mat-header-cell *matHeaderCellDef> Action Items, Recommendations and Commendattions (ARC) </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <span *ngIf="mode != 'add'">{{element.arcDesc}}</span>
        <mat-form-field *ngIf="mode === 'add'" class="example-full-width" style="width: 100%;">
          <textarea autocomplete="off" matInput placeholder="Please enter ARC"
            (change)="changeNewARC(element, findingSetups)" [(ngModel)]="arcDescforNewRow[i]"></textarea>
        </mat-form-field>
      </td>
    </ng-container>
    <ng-container matColumnDef="category">
      <th mat-header-cell *matHeaderCellDef> *ARC Category </th>
      <td mat-cell *matCellDef="let element; let i = index">
        <mat-form-field>
          <mat-select (selectionchange)="changeNewARC(element, findingSetups)" [(ngModel)]="arcCatforNewRow[i]">

            <mat-option style="color: rgb(9, 2, 2);" *ngFor="let arc of arcCategory" [value]="arc.refCode">
              {{arc.refDesc }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </td>
    </ng-container>
    <ng-container matColumnDef="editAppl">
      <th mat-header-cell *matHeaderCellDef>Edit </th>
      <td mat-cell *matCellDef="let element let i = index">

        <mat-checkbox arcEditAppforNewRow
          (click)="element.editAppl==='N' ? element.editAppl='Y': element.editAppl='N';changeNewARC(element, findingSetups)"
          [checked]="element.editAppl==='Y'" (value)="element.editAppl"></mat-checkbox>
      </td>
    </ng-container>
    <ng-container matColumnDef="delete">
      <th mat-header-cell *matHeaderCellDef> Delete</th>
      <td mat-cell *matCellDef="let element">
        <a (click)="openDialog(element)">
          <mat-icon color="warn">delete</mat-icon>
        </a>
      </td>
    </ng-container>




    <tr mat-header-row *matHeaderRowDef="displayedColumnsUsers"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumnsUsers;"></tr>
  </table>
  <!-- <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator> -->
</div>
<div class="spinner" *ngIf="showSpinner">
    <div class="fa-3x">
        <i class="fa fa-spinner fa-spin"></i>
    </div>
</div>
<div>
    <mat-card>
        <div class="row" style="display: flex;">
            <div class="col-lg-12">
                <mat-accordion class="example-headers-align" multi>
                    <mat-expansion-panel [expanded]="true">
                        <mat-expansion-panel-header #panelSearch class="mat-expansion-panel-header">
                            <mat-panel-title>
                                <div class="row" style="width: 100%;">
                                    <div class="col-lg-5">
                                        <span class="mat-panel-title-span">CTE Portal Section</span>
                                    </div>
                                    <div class="col-lg-7" style="text-align: right;" *ngIf="!isAddOrEditNewPortalSection">
                                        <button class="mt-1 cursor" mat-button style="color: #bd3640;"
                                            (click)="panelSearch._toggle(); addOrEditPortalSections('', false)">
                                            <mat-icon class="mr-10">add</mat-icon>
                                            <span class="mt-20">Add New Portal Section</span>
                                        </button>
                                    </div>
                                    <div class="col-lg-7" style="text-align: right;" *ngIf="isAddOrEditNewPortalSection">
                                        <button class="mt-1 cursor" mat-button style="color: #bd3640;"
                                            (click)="panelSearch._toggle(); saveOrUpdatePortalSection()">
                                            <mat-icon class="mr-10">save</mat-icon>
                                            <span class="mt-20">Save</span>
                                        </button>
                                        <button class="mt-1 cursor" mat-button style="color: #bd3640;"
                                            (click)="panelSearch._toggle(); isAddOrEditNewPortalSection = !isAddOrEditNewPortalSection">
                                            <mat-icon class="mr-10">cancel</mat-icon>
                                            <span class="mt-20">Cancel</span>
                                        </button>
                                    </div>
                                </div>
                            </mat-panel-title>
                        </mat-expansion-panel-header>

                        <div class="col-lg-12 mt-2" *ngIf="!isAddOrEditNewPortalSection">
                            <mat-card-content class="user-table-height mat-elevation-z8">
                                <div class="table-responsive">
                                    <table mat-table *ngIf="!refresh" [dataSource]="portalSectionResponseData" class="tbl-width">
                                        <ng-container matColumnDef="action">
                                            <th mat-header-cell *matHeaderCellDef>Action</th>
                                            <td mat-cell *matCellDef="let element">
                                                <mat-icon title="Edit" class="cursor me-2" (click)="addOrEditPortalSections(element, true)">edit</mat-icon>
                                                <mat-icon title="Edit" class="cursor me-2" (click)="deletePortalSections(element)">delete</mat-icon>
                                            </td>
                                        </ng-container>
                                        <ng-container *ngFor="let data of portalSectionMatColumnConfig; let i = index"
                                            matColumnDef="{{data.id}}">
                                            <th style="min-width: 60px;" mat-header-cell *matHeaderCellDef>{{data.name}}</th>
                                            <td mat-cell *matCellDef="let element; let j = index">
                                                <span >{{element[data.id]}}</span>
                                            </td>
                                        </ng-container>

                                        <tr mat-header-row *matHeaderRowDef="portalSectionDisplayedColumns; sticky: true"></tr>
                                        <tr mat-row *matRowDef="let row; columns: portalSectionDisplayedColumns;"></tr>
                                        <tr class="mat-row" *matNoDataRow>
                                            <td class="mat-cell" [attr.colspan]="portalSectionDisplayedColumns.length"> No data
                                                matching the filter.</td>
                                        </tr>
                                    </table>
                                </div>
                                <mat-paginator #paginator [pageSizeOptions]="[5,10, 15, 20]"
                                    showFirstLastButtons></mat-paginator>
                            </mat-card-content>
                        </div>
                        <div class="row mt-2" *ngIf="isAddOrEditNewPortalSection">
                            <ng-container *ngFor="let details of portalSectionMatColumnConfig">
                                <div class="col-3 mb-1" *ngIf="details.id != 'Content'">
                                    <mat-form-field>
                                        <mat-label>{{details.name}}</mat-label>
                                        <mat-label class="mandatory" *ngIf="details.id == 'SectionName'">*</mat-label>
                                        <input matInput autocomplete="off" [disabled]="details.id == 'CTEPortalSectionID'" [(ngModel)]="portalSectionDetails[details.id]">
                                    </mat-form-field>
                                </div>
                                <div class="row mb-2" *ngIf="details.id == 'Content'">
                                    <mat-label>{{details.name}}</mat-label>
                                    <ckeditor [config]="ckeConfig" debounce="500" [(ngModel)]="portalSectionDetails[details.id]"></ckeditor>
                                </div>
                            </ng-container>

                        </div>
                    </mat-expansion-panel>
                </mat-accordion>

            </div>
        </div>
    </mat-card>

    <mat-card>
        <div class="row" style="display: flex;">
            <div class="col-lg-12">
                <mat-accordion class="example-headers-align" multi>
                    <mat-expansion-panel [expanded]="true">
                        <mat-expansion-panel-header #panelSearch1 class="mat-expansion-panel-header">
                            <mat-panel-title>
                                <div class="row" style="width: 100%;">
                                    <div class="col-lg-5">
                                        <span class="mat-panel-title-span">CTE Portal Fields</span>
                                    </div>
                                    <div class="col-lg-7" style="text-align: right;" *ngIf="!isAddOrEditNewPortalFields">
                                        <button class="mt-1 cursor" mat-button style="color: #bd3640;"
                                            (click)="panelSearch1._toggle(); addOrEditPortalFields('', false)">
                                            <mat-icon class="mr-10">add</mat-icon>
                                            <span class="mt-20">Add New Portal Fields</span>
                                        </button>
                                    </div>
                                    <div class="col-lg-7" style="text-align: right;" *ngIf="isAddOrEditNewPortalFields">
                                        <button class="mt-1 cursor" mat-button style="color: #bd3640;"
                                            (click)="panelSearch1._toggle(); saveOrUpdatePortalFields()">
                                            <mat-icon class="mr-10">save</mat-icon>
                                            <span class="mt-20">Save</span>
                                        </button>
                                        <button class="mt-1 cursor" mat-button style="color: #bd3640;"
                                            (click)="panelSearch1._toggle(); isAddOrEditNewPortalFields = !isAddOrEditNewPortalFields">
                                            <mat-icon class="mr-10">cancel</mat-icon>
                                            <span class="mt-20">Cancel</span>
                                        </button>
                                    </div>
                                </div>
                            </mat-panel-title>
                        </mat-expansion-panel-header>

                        <div class="col-lg-12 mt-2" *ngIf="!isAddOrEditNewPortalFields">
                            <mat-card-content class="user-table-height mat-elevation-z8">
                                <div class="table-responsive">
                                    <table mat-table *ngIf="!refresh" [dataSource]="portalFieldsResponseData" class="tbl-width">
                                        <ng-container matColumnDef="action">
                                            <th mat-header-cell *matHeaderCellDef>Action</th>
                                            <td mat-cell *matCellDef="let element">
                                                <mat-icon title="Edit" class="cursor me-2" (click)="addOrEditPortalFields(element, true)">edit</mat-icon>
                                                <mat-icon title="Edit" class="cursor me-2" (click)="deletePortalFields(element)">delete</mat-icon>
                                            </td>
                                        </ng-container>
                                        <ng-container *ngFor="let data of portalFieldsMatColumnConfig; let i = index"
                                            matColumnDef="{{data.id}}">
                                            <th style="min-width: 60px;" mat-header-cell *matHeaderCellDef>{{data.name}}</th>
                                            <td mat-cell *matCellDef="let element; let j = index">
                                                <span >{{element[data.id]}}</span>
                                            </td>
                                        </ng-container>

                                        <tr mat-header-row *matHeaderRowDef="portalFieldsDisplayedColumns; sticky: true"></tr>
                                        <tr mat-row *matRowDef="let row; columns: portalFieldsDisplayedColumns;"></tr>
                                        <tr class="mat-row" *matNoDataRow>
                                            <td class="mat-cell" [attr.colspan]="portalFieldsDisplayedColumns.length"> No data
                                                matching the filter.</td>
                                        </tr>
                                    </table>
                                </div>
                                <mat-paginator #paginator1 [pageSizeOptions]="[5,10, 15, 20]" showFirstLastButtons></mat-paginator>
                            </mat-card-content>
                        </div>
                        <div class="row mt-2" *ngIf="isAddOrEditNewPortalFields">
                            <ng-container *ngFor="let details of portalFieldsMatColumnConfig">
                                <div class="col-3 mb-1" *ngIf="details.id != 'FieldInfo'">
                                    <mat-form-field>
                                        <mat-label>{{details.name}}</mat-label>
                                        <mat-label class="mandatory" *ngIf="details.id == 'SectionName'">*</mat-label>
                                        <input matInput autocomplete="off" [disabled]="details.id == 'CTEPortalSectionID'" [(ngModel)]="portalFieldsDetails[details.id]">
                                    </mat-form-field>
                                </div>
                                <div class="row mb-2" *ngIf="details.id == 'FieldInfo'">
                                    <mat-label>{{details.name}}</mat-label>
                                    <ckeditor [config]="ckeConfig" debounce="500" [(ngModel)]="portalFieldsDetails[details.id]"></ckeditor>
                                </div>
                            </ng-container>

                        </div>
                    </mat-expansion-panel>
                </mat-accordion>

            </div>
        </div>
    </mat-card>
</div>